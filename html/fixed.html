<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../css/common.css"/>
    <style>
        html, body {
            background-color: #dfdede !important;
        }

        #account {
            display: -webkit-box;
            height: 60px;
            border-bottom: solid 1px #d4d3d3;
        }

        #nickname {
            line-height: 60px;
            -webkit-box-flex: 1;
            padding-left: 10px;
        }

        #head-img {
            height: 60px;
            width: 60px;
            margin-left: 10px;
        }

        #head-img img {
            height: 40px;
            width: 40px;
            border-radius: 20px;
            margin: 10px;
        }

        li {
            position: relative;
            padding: 3px 10px;
            border-bottom: 1px solid #d4d3d3;
            background-size: 10px;
            background-repeat: no-repeat;
            background-position: 78%;
        }

        li:first-child {
            height: 46px;
            display: -webkit-box;
            -webkit-box-align: center;
        }

        .liActive {
            background-color: #919191;
        }

        li a {
            display: block;
            padding: 10px 30px;
            background-size: 20px;
            background-repeat: no-repeat;
            background-position: left;
        }
    </style>
</head>
<body>
<nav>
    <div id="account" tapmode="liActive" onclick="ShowProfile();">
        <div id="head-img"><img src="../image/default_head.jpg"/></div>
        <div id="nickname">游客</div>
    </div>
    <ul>
        <li tapmode="liActive" onclick="OpenWin('home.html')"><a class="home active">首页</a></li>
        <li tapmode="liActive" onclick="OpenWin('answer.html')"><a class="answer">答题</a></li>
        <li tapmode="liActive" onclick="OpenWin('rank.html')"><a class="rank">排名</a></li>
        <li tapmode="liActive" onclick="OpenNewWin('messageBoardFrame.html')"><a class="messageBoard">留言</a></li>
        <li tapmode="liActive" onclick="OpenWin('document.html')"><a class="more">资料</a></li>
        <li tapmode="liActive" onclick="OpenWin('more.html')"><a class="more">更多</a></li>
        <li tapmode="liActive" onclick="OpenWin('setting.html')"><a class="setting">设置</a></li>
        <li tapmode="liActive" onclick="OpenWin('about.html')"><a class="about">关于</a></li>
    </ul>
</nav>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script>
    apiready = function () {
        api.setStatusBarStyle({
            style: 'dark'
        });
        $api.fixIos7Bar($api.dom('nav'));
    };
    //变更窗口
    function OpenWin(url) {
        api.closeSlidPane();

        var $script = "ChangeWin('" + url + "');";
        api.execScript({
            name: "slide",
            script: $script
        });
    }
    //打开新窗口
    function OpenNewWin(url) {
        api.closeSlidPane();

        var $script = "OpenWin('" + url + "');";
        api.execScript({
            name: "slide",
            script: $script
        });
    }
    //更新头像与昵称
    function UpdateAvatar() {
        var userInfo = $api.getStorage('userInfo');
        if (userInfo) {
            $img = $api.dom('#head-img img');
            $nickname = $api.dom('#nickname');
            //更新头像
            if (userInfo.avatar) {
                $api.attr($img, 'src', userInfo.avatar.url);
            }
            else {
                $api.attr($img, 'src', '../image/default_head.jpg');
            }
            //更新昵称
            if (userInfo.nickname) {
                $api.html($nickname, userInfo.nickname);
            }
            else {
                $api.html($nickname, '游客');
            }
        }
    }

    function ShowProfile() {
        var userInfo = $api.getStorage('userInfo');
        if (!userInfo) {
            OpenWin('login.html')
        } else {
            OpenWin('profile.html');
        }
    }

    UpdateAvatar();
</script>
</html>