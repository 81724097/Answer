<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../css/aui.css"/>
    <style>
        html, body {
            /*background-color: #dfdede !important;*/
            background: -webkit-linear-gradient(top, #4fbcf4, #32cabe);
        }

        a {
            color: #000;
        }

        i.aui-iconfont {
            font-size: 24px;
            color: #ffffff;
        }

        #account {
            display: -webkit-box;
            color: #FFFFFF;
            height: 260px;
            width: 260px;
            background-color: #2da1da;
            position: relative;
            margin-bottom: 10px;
        }

        #nickname {
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            line-height: 80px;
            font-size: 22px;
            text-align: center;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        #head-img {
            position: absolute;
            left: 50%;
            top: 50%;
            margin-left: -65px;
            margin-top: -91px;
            height: 130px;
            width: 130px;
        }

        #head-img img {
            height: 100%;
            width: 100%;
            border: 8px solid #88caec;
            border-radius: 400px;
        }

        li {
            position: relative;
            padding: 3px 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            height: 46px;
            display: -webkit-box;
            -webkit-box-align: center;
        }

        .liActive {
            background-color: rgba(0, 0, 0, 0.3);
        }

        li a {
            display: block;
            padding: 10px 30px;
            color: #ffffff;
        }
    </style>
</head>
<body>
<nav>
    <div id="account" onclick="ShowProfile();">
        <div id="head-img"><img src="../image/default_head.jpg"/></div>
        <div id="nickname">游客</div>
        <div style="height: 10px;width: 100%;background-color: #33abdd;position: absolute;bottom: -10px;"></div>
    </div>
    <ul>
        <li tapmode="liActive" onclick="OpenWin('home.html')">
            <i class="aui-iconfont aui-icon-home"></i><a>首页</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('answer.html')">
            <i class="aui-iconfont aui-icon-edit"></i><a>答题</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('rank.html')">
            <i class="aui-iconfont aui-icon-order"></i><a>排名</a>
        </li>
        <li tapmode="liActive" onclick="OpenNewWin('messageBoardFrame.html')">
            <i class="aui-iconfont aui-icon-message"></i><a>留言</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('document.html')">
            <i class="aui-iconfont aui-icon-file"></i><a>资料</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('entertaining.html')">
            <i class="aui-iconfont aui-icon-game"></i><a>娱乐</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('more.html')">
            <i class="aui-iconfont aui-icon-more"></i><a>更多</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('setting.html')">
            <i class="aui-iconfont aui-icon-settings"></i><a>设置</a>
        </li>
        <li tapmode="liActive" onclick="OpenWin('about.html')">
            <i class="aui-iconfont aui-icon-info"></i><a>关于</a>
        </li>
    </ul>
</nav>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script>
    apiready = function () {
        //动态适配UI
        var $nav = $api.dom('nav');
        $api.fixIos7Bar($nav);
        var navWidth = api.winWidth - 60;
        $api.css($nav, 'width:' + navWidth + 'px;');

        var $account = $api.dom('#account');
        $api.css($account, 'height:' + navWidth + 'px;width:' + navWidth + 'px;background-color:#2da1da;');
        var $imgContainer = $api.dom('#head-img');
        var imgWidth = navWidth * 0.5;
        $api.css($imgContainer, 'height:' + imgWidth + 'px;width:' + imgWidth + 'px;margin-left:-' + imgWidth * 0.5 + 'px;margin-top:-' + imgWidth * 0.7 + 'px;');
    };

    //变更窗口
    function OpenWin(url) {
        api.closeSlidPane();

        var $script = "ChangeWin('" + url + "');";
        api.execScript({
            name: "slide",
            script: $script
        });
    }
    //打开新窗口
    function OpenNewWin(url) {
        api.closeSlidPane();

        var $script = "OpenWin('" + url + "');";
        api.execScript({
            name: "slide",
            script: $script
        });
    }
    //更新头像与昵称
    function UpdateAvatar() {
        var userInfo = $api.getStorage('userInfo');
        if (userInfo) {
            $img = $api.dom('#head-img img');
            $nickname = $api.dom('#nickname');
            //更新头像
            if (userInfo.avatar) {
                $api.attr($img, 'src', userInfo.avatar.url);
            }
            else {
                $api.attr($img, 'src', '../image/default_head.jpg');
            }
            //更新昵称
            if (userInfo.nickname) {
                $api.html($nickname, userInfo.nickname);
            }
            else {
                $api.html($nickname, '游客');
            }
        }
    }

    function ShowProfile() {
        var userInfo = $api.getStorage('userInfo');
        if (!userInfo) {
            OpenWin('login.html')
        } else {
            OpenWin('profile.html');
        }
    }

    UpdateAvatar();
</script>
</html>