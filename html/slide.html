<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>slide</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../css/aui.css"/>
    <style>
        * {
            outline: 0;
        }

        header.aui-bar-nav {
            /*background-color: #f2f2f2;*/
            border-bottom: 1px solid #52a7e2;
            background-color: #4fbcf4;
            color: #FFFFFF;
        }
    </style>
</head>
<body>
<header class="aui-bar aui-bar-nav">
    <a class="aui-pull-left" onclick="sliding();">
        <span class="aui-iconfont aui-icon-sort"></span>
    </a>
    <div class="aui-title">Answer</div>
    <a class="aui-pull-right" onclick="BackHome();">
        <span class="aui-iconfont aui-icon-home"></span>
    </a>
</header>
<script type="text/javascript" src="../script/api.js"></script>
<script>
    var currectFrame = '';
    apiready = function () {
        $api.fixStatusBar($api.dom('header'));

        //打开首页
        ChangeWin('home.html');

        ExitApp();//退出应用监听
    };

    function sliding() {
        api.openSlidPane({
            type: 'left'
        });
    }
    //回到首页
    function BackHome(){
        ChangeWin('home.html');
    }
    //变更窗口
    function ChangeWin(url) {
        currectFrame = url;
        var headerHeight = $api.offset($api.dom("header")).h;
        var name = url.split('.')[0];
        api.openFrame({
            name: name,
            url: './index/'+url,
            rect: {
                x: 0,
                y: headerHeight,
                w: api.winWidth,
                h: api.winHeight - headerHeight
            },
            bounces: false,
            vScrollBarEnabled: true,
            hScrollBarEnabled: false,
            reload:true,
            bgColor:'#ffffff'
        });
    }
    //打开新窗口
    function OpenWin(url){
        //打开首页
        var name = url.split('.')[0];
        api.openWin({
            name : name,
            url : './index/' + url
        });
        ChangeWin('home.html');
    }

    //双击back退出应用事件监听
    function ExitApp(){
        api.addEventListener({
            name: 'keyback'
        }, function(ret, err){
            if(currectFrame != 'home.html'){
                BackHome();
            }else{
                api.toast({
                    msg: '再按一次返回键退出应用',
                    duration:2000,
                    location: 'bottom'
                });

                api.addEventListener({
                    name: 'keyback'
                }, function(ret, err){
                    api.closeWidget();
                });

                setTimeout(function(){
                    api.removeEventListener({
                        name: 'keyback'
                    });
                    ExitApp();
                },3000);
            }
        });
    }
</script>
</body>
</html>