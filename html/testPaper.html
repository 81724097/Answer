<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../css/common.css"/>
    <link rel="stylesheet" type="text/css" href="../css/aui.css"/>
    <style>
        #main {
            padding: 0;
            width: 100%;
            height: auto;
            overflow: hidden;
        }

        div.question-content img {
            width: 100%;
            height: auto;
        }

        div.question {
            display: none;
        }

        div.question.actived {
            width: 100%;
            height: auto;
            display: block;
        }

        div.aui-input-row {
            width: 100%;
        }

        div.aui-input-row span {
            display: inline-block;
            line-height: 42px;
            vertical-align: middle;
        }

    </style>
</head>
<body>
<div id="main">
</div>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript">
    var rightNum = 0;//正确答案数
    var currentNum = 1;//当前题目编号
    var currentSelectedRight = false;//当前选择的是否正确
    var testQuestion;//所有问题数组
    apiready = function () {
        testQuestion = api.pageParam.testQuestion;

        //循环添加题目
        for (var i = 0; i < testQuestion.length; i++) {
            var data = testQuestion[i];
            var content = data.questionContent;
            var trueanswer = parseInt(data.trueanswer);
            var answer = [data.answer1, data.answer2, data.answer3, data.answer4];

            var html = '';
            if (i == 0) {
                html += '<div class="question actived">';
            } else {
                html += '<div class="question">';
            }
            html += '<div class="question-content">';
            //添加图片
            if (data.pic) {
                html += '<img src="' + data.pic.url + '"></img>'
            }
            html += (i + 1).toString() + '.' + content + '</div>';
            html += '<form class="question-options aui-form">';
            for (var j = 0; j < 4; j++) {
                if (j + 1 == trueanswer) {
                    html += '<div class="aui-input-row" onclick="SelectItem(this,true)">';
                }
                else {
                    html += '<div class="aui-input-row" onclick="SelectItem(this)">';
                }
                html += '<input class="aui-pull-left aui-radio aui-radio-info" type="radio" name="' + i + '"/>';
                html += '<span>' + answer[j] + '</span>';
                html += '</div>'
            }
            html += '</form>';
            html += '</div></div>';

            $api.append($api.dom('#main'), html);
        }
    };

    function SelectItem(obj, res) {
        $api.dom(obj, 'input').checked = true;//显示切换
        if (res) {
            currentSelectedRight = true;//答案正确
        }
        else {
            currentSelectedRight = false;
        }
    }

    //切换到下一题
    function NextQuestion() {
        //判断是否正确
        if (currentSelectedRight) {
            rightNum++;//如果当前正确则正确数+1
            currentSelectedRight = false;
        }
        currentNum++;//当前题目编号自增
        //切换到下一题
        $contents = $api.domAll('div.question');
        for (var i = 0; i < testQuestion.length; i++) {
            $api.removeCls($contents[i], 'actived');
        }
        $api.addCls($contents[currentNum - 1], 'actived');
    }

    //todo 交卷
    function SubmitQuestion() {
        alert("交卷");
    }
    //todo 切换上一题
    function PrevQuestion() {
        alert("上一题");
    }
</script>
</html>